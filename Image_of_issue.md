# Представление issue в модели данных git.

### Создание issue:
Пользователь вводит команду `git bug new` или `git bug new -m “...”`, предоставляя *summary* и *description* нового issue. В текущем репозитории git создается 3 blob объекта (*status*, *summary*, *description*), которые хранят обязательные атрибуты issue. 

#### Описание blob объектов, хранящих атрибуты issue:

##### 1.blob status:
В blob объекте *status* хранится текущее состояние *issue* - строка *“open”* или *“resolved”*, обозначающая соответствующее состояние. При создании issue присваивается значение *“open”*.

##### 2.blob summary:
В blob объекте summary хранится текст содержащий текущий summary issue. При создании issue присваивается значение первой строки пользовательского ввода.

##### 3.blob description:
В blob объекте *description* хранится текст содержащий текущий description issue. При создании issue присваивается весь текст полученный от пользователя при вводе начиная со второй строки.

Из этих blob объектов создается дерево. Далее создается коммит на дерево с blob объектами, который будет отражать дату создания и автора issue. Хэш этого коммита (далее обозначается как хэш issue) выдается пользователю по завершению работы команды, как хэш по которому пользователь может осуществлять операции над issue.
Создается новый blob с названием равным хэшу issue, содержащий в себе строку с хэшем issue. (В пункте *“изменение issue”* обосновываются причины создания этого blob объекта). Из этого blob объекта создается дерево. Проверяется наличие ссылки *".issues-reserved"* в репозитории, делается коммит на созданное дерево, если ссылка существует, то в parent нового коммита указывается коммит на который указывает ссылка, в обратном случае коммит остается без parent, и создается ссылка *".issues-reserved"* указывающая на этот коммит. 

### Изменение issue:

На данный момент предполагается 2 варианта изменения issue:

1.Пользователь вводит команду `git bug edit <hash>`, предоставляя измененные варианты атрибутов *summary* и *description*, создается два blob объекта summary и description, так как описано в пункте *“Описание blob объектов, хранящих атрибуты issue”*, из них создается дерево (далее обозначается как дерево изменений). (дальнейшие действия описаны в пункте *“Обработка дерева изменений”*)

2.Пользователь вводит команду `git bug resolve <hash>`, запрашивая изменения статуса issue на *“resolved”*. Создается blob объект status, содержащий строку *“resolved”*, из него создается дерево (далее обозначается как дерево изменений). (дальнейшие действия описаны в пункте *“Обработка дерева изменений”*)

#### Обработка дерева изменений:

Ищется последняя версия blob объекта (с названием равным введенному хэшу) по ссылке *".issues-reserved"*, создается коммит на *“дерево изменений”*, где как хэш parent коммита указывается содержание найденного blob объекта (далее созданный коммит обозначается как коммит изменений). Коммит изменений отражает дату и автора изменения issue.
Создается новый blob с названием равным введенному хэшу, содержащий в себе строку с хэшем “коммита изменений”, из этого blob объекта создается дерево, делается коммит на это дерево, как parent коммит указывается коммит, на который указывает ссылка *".issues-reserved"*. Ссылке *".issues-reserved"* присваивается хэш созданного коммита.
